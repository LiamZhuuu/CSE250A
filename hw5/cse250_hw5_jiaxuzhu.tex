\documentclass{article}
\usepackage[left=3cm,right=3cm,top=2cm,bottom=2cm]{geometry} % page settings
\usepackage{amsmath} % provides many mathematical environments & tools
\usepackage{graphicx}
\usepackage{mathrsfs}
\usepackage{amssymb}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{mathtools}
\usepackage{textcomp}

\setlength{\parindent}{0mm}
\makeatletter
\setlength{\@fptop}{0pt}
\makeatother
\def\BState{\State\hskip-\ALG@thistlm}

\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}


\begin{document}

\title{CSE 250A: Assignment 5}
\author{Jiaxu Zhu~~A53094655}
\date{\today}
\maketitle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{5.1 EM algorithm}
\subparagraph*{(a)~Posterior probability}
\begin{eqnarray*}
	P(a,c|b,d) &=& \frac{P(a,c,b,d)}{P(b,d)}\\
	&=&\frac{P(a,c,b,d)}{\sum_{a',c'}P(a',b,c',d)}\\
	&=&\frac{P(a)P(b|a)P(c|a,b)P(d|b,c)}{\sum_{a',c'}P(a')P(b|a')P(c'|a',b)P(d|b,c')}
\end{eqnarray*}

\subparagraph*{(b)~Posterior probability}
\begin{eqnarray*}
	P(a|b,d) &=& \sum_{c'}P(a,c'|b,d)\\
	P(c|b,d) &=& \sum_{a'}P(a',c|b,d)\\ 
\end{eqnarray*}

\subparagraph*{(c)~Log-likelihood}
\begin{eqnarray*}
	\mathcal{L} &=& \sum_{t}\log P(B = b_t, D = d_t)\\
	&=& \sum_{t}\log \sum_{a', c'}P(A = a', B = b_t, C = c', D = d_t)\\
	&=& \sum_{t}\log \sum_{a',c'}P(A=a')P(B=b_t|A=a')P(C=c'|A=a',B=b_t)P(D=d_t|B=b_t,C=c')
\end{eqnarray*}

\subparagraph*{(d)~EM algorithm}
\subparagraph*{E-step}
\begin{eqnarray*}
	P(b,a|b_t, d_t) &=& I(b, b_t)P(a|b_t, d_t)\\
	P(c, a, b | b_t, d_t) &=& I(b, b_t)P(a, c|b_t, d_t)\\
	P(d, b, c | b_t, d_t) &=& I(b, b_t)I(d, d_t)P(c|b_t, d_t)\\
\end{eqnarray*}
\subparagraph*{M-step}
\begin{eqnarray*}
	P(b | a) &=& \frac{\sum_{t}P(b, a|b_t, d_t)}{\sum_{t}P(a|b_t, d_t)}\\
	&=& \frac{\sum_{t}I(b, b_t)P(a|b_t, d_t)}{\sum_{t}P(a|b_t, d_t)}\\
	P(c, a, b | b_t, d_t) &=& \frac{\sum_{t}P(c, b, a|b_t, d_t)}{\sum_{t}P(a, b|b_t, d_t)}\\
	&=& \frac{\sum_{t}I(b, b_t)P(a, c|b_t, d_t)}{\sum_{t}I(b, b_t)P(a|b_t, d_t)}\\
	P(d, b, c | b_t, d_t) &=& \frac{\sum_{t}P(d, c, b|b_t, d_t)}{\sum_{t}P(b, c|b_t, d_t)}\\
	&=& \frac{\sum_{t}I(b, b_t)I(d, d_t)P(c|b_t, d_t)}{\sum_{t}I(b, b_t)P(c|b_t, d_t)}\\
\end{eqnarray*}

\subsection*{5.2 EM algorithm for noisy-OR}
\subparagraph*{(a)}
\begin{eqnarray*}
	P(Y = 1| X) &=& \sum_{Z \in \{0,1\}^n}P(Y =1 ,Z | X)\\	
	&=& \sum_{Z \in \{0,1\}^n}P(Y =1 |Z , X)P(Z|X)
\end{eqnarray*}
\end{document}

